const express=require('express');
const router=express.Router();
const Student=require('./../models/Student');

//signup route
router.get('/signup',(req,res)=>{
  return res.render('signup');
})
router.post('/signup',async(req,res)=>{
    try{
      const data=req.body;// extracting data fron the request
      const newStudent= Student(data);//creating new object and storing data in that
      await newStudent.save();// saving new data


      res.status(200).json({message: 'User register successfully'});
  
    }
   catch(err){
    console.log(err);
    res.status(400).json({error:'Internal Server Error'});
   }
  })

  //login route
  router.get('/login',(req,res)=>{
    return res.render('login');
  })

  router.post('/login',async(req,res)=>{
   // Extract email and password from the body
   try{
   const { email, password } = req.body;

   // Find the user by email
   const user = await Student.findOne({ email: email });

   // If user does not exist or password does not match, return error
   if (!user || user.password !== password) {
     return res.status(401).json({ error: 'Invalid username or password' });
   }

   res.status(200).render('lost');
 } catch(err) {
   console.error(err);
   res.status(500).json({ error: 'Internal Server Error' });
 }
  })

  //view profile routes
  router.get('/profile',async(req,res)=>{

  })

  module.exports=router;